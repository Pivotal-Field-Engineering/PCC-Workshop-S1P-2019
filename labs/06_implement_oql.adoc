## Implement Cloud Cache Native querying for retrieving data

Cloud Cache is primarily a key-value store with additional capability of querying the stored java objects using sql-like query engine called Object Query Language (OQL). In this section we'll implement OQL for retrieving pizza orders using email address of customers and also demonstrate use of indexes for improving the query resposne time.

#### Step 1: Lets implement an OQL query for retrieving orders from /Pizza region using @query annotation. We can use @query annotation for executing custom queries in repositories. We need to make below changes in PizzaRepository.java

```
@Query("SELECT * FROM /Pizza p WHERE p.sauce.name = $1" )
List<Pizza> findPizzasBySauceType(String sauce);
```

#### Step 2: Implement api for searching orders in AppController.java

```
@RequestMapping(method = RequestMethod.GET, path = "/orders")
@ResponseBody
public String getPizzasBySauceType(@RequestParam(value = "sauce", required = true) String sauce) {

	List<Pizza> pizzaObjects = pizzaRepository.findPizzasBySauceType(sauce);

    if (pizzaObjects != null && pizzaObjects.size() > 0) {

    	pizzaObjects.forEach(item -> result.append(item + "</br>"));

    	return String.format("Result [<b>%1$s</b>] <br/>", result.toString());
    }
	return "No Results Found.";
}
```

#### Step 5: Rebuild and push the app

#### Step 6: Query the order using /orders endpoint

http://pizza-store-pcc-client.xyz.com/orders?email=williamcantu@gmail.com

```
Result [Pizza{name='fancy', toppings=[arugula, chicken], sauce='pesto', Customer='Customer [id=81Q4AdLpE, name=William Cantu, email=williamcantu@gmail.com, address=64945 New York, birthday=1969-07-11T00:12:43.229Z]'}
Pizza{name='fancy', toppings=[arugula, chicken], sauce='pesto', Customer='Customer [id=81Q4AdLpE, name=William Cantu, email=williamcantu@gmail.com, address=64945 New York, birthday=1969-07-11T00:12:43.229Z]'}
]
Elapsed Time [11 ms]
```